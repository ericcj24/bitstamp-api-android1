this version only works for transaction
